!function(){"use strict";if(window.__navLoaderActive)return;window.__navLoaderActive=!0;const e={placeholderSelector:"#nav-menu",partialPath:"/partials/nav.html",fetchOptions:{cache:"no-store"},enableLog:!1,forceReload:!1};function t(...t){e.enableLog&&console.log("[nav-loader]",...t)}async function a(){const a=document.querySelector(e.placeholderSelector);if(a)if("true"!==a.dataset.partialLoaded||e.forceReload)try{const r=await fetch(e.partialPath,e.fetchOptions);if(!r.ok)return void console.error("[nav-loader] fetch fallito:",r.status,e.partialPath);const n=await r.text(),i=(new DOMParser).parseFromString(n,"text/html"),c=i.querySelector("ul"),l=c?c.innerHTML.trim():i.body.innerHTML.trim(),s=(a.innerHTML||"").trim();if(s&&s===l&&!e.forceReload)return t("Contenuto identico già presente nel placeholder, skip iniezione."),void(a.dataset.partialLoaded="true");a.innerHTML="",a.innerHTML=c?c.innerHTML:i.body.innerHTML,a.dataset.partialLoaded="true",t("Nav iniettata con successo."),function(e){const t=o(location.pathname||"/");e.querySelectorAll("a.nav-link").forEach(e=>{const a=e.getAttribute("href")||"";if(/^(mailto:|tel:|javascript:|#)/i.test(a))return;let r;try{r=new URL(a,location.origin).pathname}catch{r=a}r=o(r),r===t?(e.setAttribute("aria-current","page"),e.classList.add("is-active")):(e.removeAttribute("aria-current"),e.classList.remove("is-active"))})}(a)}catch(e){console.error("[nav-loader] errore:",e)}else t("Placeholder già popolato; esco.");else console.warn("[nav-loader] placeholder non trovato:",e.placeholderSelector)}function o(e){return""===(e=(e=(e=(e||"").split("?")[0].split("#")[0]).replace(/index\.html$/i,"")).replace(/\/+$/g,""))?"/":e}document.addEventListener("DOMContentLoaded",a),window.navLoader={load:a,config:e}}();