<!DOCTYPE html><html lang="it"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Estrattore Palette colore - Codedge</title><meta name="description" content="Carica una foto e ottieni palette colori, suggerimenti di contrasto, gradienti, ruoli UI, CSS variables e JSON esportabili. Tutto client-side."><link rel="canonical" href="https://codedge.it/strumenti/estrattore-palette/"><link rel="icon" href="/assets/icons/codedge-logo-minimal.svg" sizes="any" type="image/svg+xml"><link rel="icon" href="/assets/icons/favicon-32.png" sizes="32x32" type="image/png"><link rel="icon" href="/assets/icons/favicon-16.png" sizes="16x16" type="image/png"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/icons/android-chrome-192.png" sizes="192x192" type="image/png"><link rel="icon" href="/assets/icons/android-chrome-512.png" sizes="512x512" type="image/png"><link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png" sizes="180x180"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/assets/icons/favicon-mask.svg" color="#00A8FF"><meta name="theme-color" content="#00A8FF"><link rel="preload" href="/css/components/main.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript><link rel="preload" href="/css/components/navbar.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><link rel="preload" href="/css/components/footer.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/css/components/navbar.css"><link rel="stylesheet" href="/css/components/footer.css"></noscript><script src="/js/components/navbar.js" defer=""></script><script src="/js/components/button.js" defer=""></script><script src="/js/components/footer.js"></script><script src="/js/components/navbar-loader.js"></script><style>@keyframes flashOutline{0%{box-shadow:0 0 0 0 rgba(0,123,240,.6)}to{box-shadow:0 0 0 10px transparent}}:root{--bg:#2a2a2a;--panel:#3a3a3a;--panel-2:#363636;--card-grad:linear-gradient(180deg, #3c3c3c, #373737);--surface-grad:linear-gradient(180deg, var(--panel), var(--panel-2));--btn-grad:linear-gradient(180deg, #404040, #353535);--text:#f2f2f2;--muted:#e0e0e0;--hover:#007bf0;--radius:14px;--radius-lg:16px;--gap:12px;--shadow-sm:0 1px 0 rgba(0, 0, 0, 0.55);--shadow-inset:inset 0 1px 0 rgba(255, 255, 255, 0.04);--shadow-card:0 20px 60px rgba(0, 0, 0, 0.45);--shadow-panel:0 12px 32px rgba(0, 0, 0, 0.38);--panel-heading-gap:18px}*{box-sizing:border-box}.thumb img,body,html{height:100%}.tiny,body{color:var(--text)}body{margin:0;background:var(--bg);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;line-height:1.4}h1{font-size:clamp(20px, 4vw, 30px);margin:0 0 8px}h2{font-size:1.5rem;text-align:center;margin:20px}.panel h3{margin:0 0 var(--panel-heading-gap)}.tiny{font-size:.95rem;opacity:.92;line-height:1.7}.wrap{width:100%;max-width:none;padding-inline:clamp(12px,4vw,48px);padding-block:18px;margin:0 auto}.card{background:var(--card-grad);border-radius:var(--radius-lg);border:0;box-shadow:var(--shadow-card),var(--shadow-inset);padding:18px;width:100%;overflow:auto}.block,.panel{padding:16px}.block,.panel,.role-row{background:var(--surface-grad);border-radius:var(--radius);box-shadow:var(--shadow-panel),var(--shadow-inset);border:0}.grid{display:grid;grid-template-columns:minmax(0,1.1fr) minmax(0,0.9fr) minmax(0,0.9fr);gap:18px;padding:18px}@media (max-width:1200px){.grid{grid-template-columns:1fr;padding:12px;gap:14px}}.upload{gap:var(--gap);justify-content:space-between;padding:22px;border:2px dashed var(--hover);border-radius:14px;background:var(--surface-grad);position:relative;box-shadow:0 10px 28px rgba(0,0,0,.35);transition:box-shadow .15s ease;flex-wrap:wrap}.upload.dragover{border-color:var(--hover);box-shadow:inset 0 0 0 3px rgba(0,123,240,.25),0 10px 28px rgba(0,123,240,.15)}.upload,.upload .left{display:flex;align-items:center}.upload .left{gap:16px;min-width:0}.thumb{width:clamp(96px,16vw,260px);aspect-ratio:16/9;border-radius:12px;background:#2f2f2f;display:grid;place-items:center;overflow:hidden;box-shadow:inset 0 1px 0 rgba(255,255,255,.03),var(--shadow-sm);flex:0 0 auto}.thumb img{display:block;width:100%;object-fit:cover}.foot,.row,.upload .actions{display:flex;gap:8px;flex-wrap:wrap}.foot{margin-top:10px}.upload .actions{align-items:center}.ghost,.primary,button{background:var(--btn-grad)}.ghost,button{border:0;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:600;min-height:44px;transition:transform 80ms ease,box-shadow .15s ease,background-color .15s ease;box-shadow:inset 1px 1px 0 rgba(255,255,255,.1),inset -1px -1px 0 rgba(0,0,0,.3),0 2px 4px rgba(0,0,0,.2)}.ghost:active,button:active{transform:translateY(1px)}.ghost:hover,.primary:hover,button:hover{background:var(--hover);box-shadow:inset 0 .5px 0 rgba(255,255,255,.08),0 1px 0 rgba(0,0,0,.45),0 3px 6px rgba(0,123,240,.12)}.primary{margin-left:5px}.palette{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:12px}.swatch{border-radius:12px;background:#2f2f2f;overflow:hidden;box-shadow:inset 0 1px 0 rgba(255,255,255,.03),0 1px 0 rgba(0,0,0,.6)}.swatch .chip{height:84px}.swatch .meta{padding:10px;font:12px/1.4 ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace;color:var(--muted)}.role-row{display:flex;align-items:center;gap:12px;padding:10px 12px}.grad-pill,.role-row .chip-role{border:1px solid rgba(204,204,204,.22)}.role-row .chip-role{width:44px;height:44px;border-radius:10px;flex:0 0 auto}.grad-pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;min-height:44px;background:linear-gradient(180deg,#3b3b3b,#343434);box-shadow:inset 0 1px 0 rgba(255,255,255,.05),0 2px 0 rgba(0,0,0,.5),0 10px 22px rgba(0,0,0,.3);cursor:pointer;margin:auto}.badge,.grad-chip,.grad-pill{border-radius:999px}.grad-chip{width:14px;height:14px;display:inline-block;vertical-align:middle;box-shadow:0 0 0 1px rgba(204,204,204,.22) inset;pointer-events:none}.grad-pill .label{white-space:nowrap}.grad-pill.flash{animation:flashOutline .62s ease-out}.badge{display:inline-flex;align-items:center;gap:6px;padding:2px 8px;font-size:11px;border:1px solid rgba(204,204,204,.22);background:0 0}.mt8{margin-top:8px}.mt12{margin-top:12px}.center{text-align:center}.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace}.two{display:grid;grid-template-columns:1fr 1fr;gap:12px}@media (max-width:820px){.two{grid-template-columns:1fr}}.ghost:focus-visible,.grad-pill:focus-visible,.upload:focus-visible,button:focus-visible{outline:3px solid var(--hover);outline-offset:2px;box-shadow:0 0 0 3px rgba(0,123,240,.25)}.grid>*,.left,.mono,.panel,.role-row,.row,.thumb,button,input,label{min-width:0}.mono,button,input,label{word-break:break-word}.site-footer,footer{position:static;width:100%;z-index:auto}@media (max-width:520px){.upload{flex-direction:column;align-items:stretch;padding:16px;gap:12px}.upload .left{width:100%;gap:12px;align-items:center;min-width:0}.thumb{width:96px;height:auto;aspect-ratio:4/3}.upload .actions{justify-content:flex-end;width:100%;gap:8px;flex-wrap:wrap}.upload .actions .primary{min-width:120px;max-width:100%;white-space:nowrap;align-self:center;z-index:2}.upload .actions .ghost,.upload .actions button{flex:0 0 auto}}</style></head><body><header><nav class="navbar"><div class="navbar-container"><img src="/assets/icons/codedge-logo.svg" alt="Logo codedge" class="logo" width="80" height="35"><h1 class="resize-text"><i class="fas fa-eye-dropper"></i> Estrattore Palette</h1><div class="menu-icon"><span class="bar"></span> <span class="bar"></span> <span class="bar"></span></div><ul id="nav-menu" class="nav-menu"></ul></div></nav><div id="breadcrumb-container" aria-hidden="false"></div><script src="/js/components/breadcrumb-loader.js" defer=""></script></header><h2>Estrai palette colori dalla tua foto — CSS, gradienti e JSON</h2><div class="wrap"><div class="card"><p class="tiny">Carica una <strong>foto</strong> o trascinala qui: ottieni <strong>palette dominanti</strong>, suggerimenti di <strong>contrasto</strong>, <strong>gradienti</strong>, ruoli <strong>UI</strong> (bg/primary/accent), e <strong>CSS variables</strong> + <strong>JSON</strong> esportabili. Tutto <em>client-side</em>.</p><div class="grid"><div class="panel"><h3>Input immagine</h3><div class="upload" id="drop" role="button" aria-label="Carica immagine: clicca o trascina e rilascia" aria-describedby="drop-hint"><div class="left"><div class="thumb" id="thumb"><span class="tiny">anteprima</span></div><div><div class="tiny" id="drop-hint">Consiglio: immagini &lt; 4MB • verranno ridotte per l'analisi (max 500px)</div><div class="foot"><label class="ghost" for="file">Scegli file…</label> <input id="file" type="file" accept="image/*" hidden=""> <button id="demo" class="ghost">Usa demo</button> <button id="reset" class="ghost">Reset</button></div></div></div><div class="actions"><button id="analyze" class="primary">Estrai palette</button></div></div><div class="two mt12"><div class="block"><div class="tiny">Dimensioni immagine</div><div id="info-dim" class="mono">—</div></div><div class="block"><div class="tiny">Luminosità media</div><div class="bar" id="avg-bar-outer" role="progressbar" aria-valuemin="0" aria-valuemax="255" aria-valuenow="0" aria-label="Luminosità media"><div id="avg-bar" style="width: 0;
                      background: linear-gradient(90deg, #4a4a4a, #9a9a9a);"></div></div><div id="avg-val" class="mono tiny">—</div></div></div></div><div class="panel"><h3>Palette dominante</h3><div id="palette" class="palette"><div class="hint">Carica un'immagine e premi “Estrai palette”.</div></div></div><div class="panel"><h3>Ruoli UI suggeriti</h3><p class="roles-desc tiny">Significato pratico: <strong>Background</strong> = colore di fondo della pagina; <strong>Primary</strong> = colore principale (brand, titoli, bottoni); <strong>Accent</strong> = tocchi di evidenza/CTA/link; <strong>Text</strong> = colore del testo che massimizza il contrasto su Background.</p><div id="roles" class="two"><div class="role-row" id="role-bg"><div class="chip-role"></div><div class="role-meta"><div class="role-name">Background</div><div class="role-hex mono tiny">—</div></div></div><div class="role-row" id="role-primary"><div class="chip-role"></div><div class="role-meta"><div class="role-name">Primary</div><div class="role-hex mono tiny">—</div></div></div><div class="role-row" id="role-accent"><div class="chip-role"></div><div class="role-meta"><div class="role-name">Accent</div><div class="role-hex mono tiny">—</div></div></div><div class="role-row" id="role-text"><div class="chip-role"></div><div class="role-meta"><div class="role-name">Text</div><div class="role-hex mono tiny">—</div></div></div></div><div class="mt12"><div class="tiny">Gradienti (sfumature) <span style="opacity: 0.85">— clicca per copiare il CSS</span></div><ul id="grads-help" class="tiny grad-explain"><li><strong>Contrasto forte</strong>: sfumatura tra i <em>due colori più diversi</em> della foto. Per hero/sfondi che devono spiccare.</li><li><strong>Evidenza → Principale</strong>: dal colore di <em>evidenza</em> (accent) al colore <em>principale</em> del tema. Per bottoni/CTA o badge.</li></ul><div id="grads" class="row mt8"></div></div></div><div class="panel"><h3>Cos’è e come usarlo</h3><p class="tiny">Carica una foto, estrai la palette, poi usa i ruoli UI per costruire rapidamente un tema. Mantieni il <strong>contrasto</strong> almeno AA per testi e bottoni. Esporta le variabili CSS o il JSON e incollale nel tuo progetto.</p><ol class="tiny" style="margin: 0; padding-left: 18px; line-height: 1.6"><li><strong>Carica</strong> immagine e premi “Estrai palette”.</li><li><strong>Seleziona</strong> i colori proposti come Background/Primary/Accent/Text.</li><li><strong>Verifica</strong> i rapporti (pallini e numeri) e scegli combinazioni leggibili.</li><li><strong>Esporta</strong> CSS/JSON e usali nel tuo progetto.</li></ol></div><div class="panel"><h3>Esporta</h3><div class="row"><button id="copy-css">Copia CSS variables</button> <button id="copy-json">Copia JSON</button> <button id="dl-css">Download .css</button> <button id="dl-json">Download .json</button></div><div class="mt8 tiny" id="export-info" role="status" aria-live="polite">—</div><details class="mt12"><summary class="tiny">Diagnostica</summary><div class="tiny mono" id="diag">Pronto.</div></details></div></div></div><p class="tiny center mt12">MVP client-side. K-Means su campionamento — 6 cluster. WCAG contrast.</p></div><canvas id="canvas" style="display: none"></canvas><script>!function(){"use strict";const t=t=>t.toString(16).padStart(2,"0"),e=({r:e,g:n,b:a})=>"#"+t(e)+t(n)+t(a);function n(t,e,n){t/=255,e/=255,n/=255;const a=Math.max(t,e,n),r=Math.min(t,e,n);let o,c,i=(a+r)/2;if(a===r)o=c=0;else{const s=a-r;switch(c=i>.5?s/(2-a-r):s/(a+r),a){case t:o=(e-n)/s+(e<n?6:0);break;case e:o=(n-t)/s+2;break;default:o=(t-e)/s+4}o/=6}return{h:Math.round(360*o),s:Math.round(100*c),l:Math.round(100*i)}}function a({r:t,g:e,b:n}){const a=[t,e,n].map(t=>t/255).map(t=>t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4));return.2126*a[0]+.7152*a[1]+.0722*a[2]}function r(t,e){const n=a(t),r=a(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function o(t){const e={r:255,g:255,b:255},n={r:0,g:0,b:0},a=r(t,e),o=r(t,n);return a>=o?{hex:"#ffffff",ratio:a,rgb:e}:{hex:"#000000",ratio:o,rgb:n}}const c=t=>document.getElementById(t),i=c("file"),s=c("drop"),l=c("thumb"),d=c("analyze"),h=c("info-dim"),g=c("avg-bar"),u=c("avg-val"),p=c("palette"),f={bg:c("role-bg"),primary:c("role-primary"),accent:c("role-accent"),text:c("role-text")},b=c("grads"),m=c("export-info"),x=c("diag"),v=c("copy-css"),y=c("copy-json"),w=c("dl-css"),C=c("dl-json"),k=c("demo"),M=c("reset");let L=[],E=null;function S(t){l.innerHTML='<img alt="Anteprima immagine" src="'+t+'"/>'}function A(t){return new Promise((e,n)=>{const a=new FileReader;a.onload=()=>e(a.result),a.onerror=n,a.readAsDataURL(t)})}function D(t,e){return r(t,e)}function T(t,e,n,a){const r=document.createElement("div");return r.className="grad-pill",r.setAttribute("role","button"),r.tabIndex=0,r.innerHTML='<span class="grad-chip" style="background:'+e+'"></span><span class="label">'+t+'</span><span class="grad-chip" style="background:'+n+'"></span>',r.style.background="linear-gradient(90deg,"+e+","+n+")",r.style.color=o(function(t){let e=t.replace("#","");return 3===e.length&&(e=e.split("").map(t=>t+t).join("")),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)}}(e)).hex,r.dataset.from=e,r.dataset.to=n,r.dataset.label=t,r.title=(a||t)+" — "+e+" → "+n+" (clicca per copiare CSS)",r}async function H(t){try{if(!navigator.clipboard||!window.isSecureContext)throw new Error("clipboard non disponibile");return await navigator.clipboard.writeText(t),{ok:!0,method:"clipboard"}}catch(e){try{const e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="fixed",e.style.top="-9999px",e.style.opacity="0",document.body.appendChild(e),e.focus(),e.select(),e.setSelectionRange(0,e.value.length);const n=document.execCommand("copy");if(document.body.removeChild(e),!n)throw new Error("execCommand fallito");return{ok:!0,method:"execCommand"}}catch(t){return{ok:!1,error:t}}}}function I(t,e){const n=new Blob([e],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(n),a.download=t,a.click(),setTimeout(()=>URL.revokeObjectURL(a.href),1e3)}function j(){if(!L.length)return"";const t=[":root {"];return L.forEach((e,n)=>t.push("  --color-"+(n+1)+": "+e.hex+";")),E&&t.push("  --bg: "+E.bg.hex+";","  --primary: "+E.primary.hex+";","  --accent: "+E.accent.hex+";","  --text: "+E.text.hex+";"),t.push("}","","/* Esempio d'uso */","body { background: var(--bg); color: var(--text); }",".btn-primary { background: var(--primary); color: var(--text); }",".btn-accent { background: var(--accent); color: var(--text); }"),t.join("\n")}function R(){const t={palette:L.map(t=>({hex:t.hex,rgb:{r:t.r,g:t.g,b:t.b}})),roles:E?{bg:E.bg.hex,primary:E.primary.hex,accent:E.accent.hex,text:E.text.hex}:null};return JSON.stringify(t,null,2)}i.addEventListener("change",async t=>{const e=t.target.files&&t.target.files[0];e&&S(await A(e))}),s.addEventListener("dragover",t=>{t.preventDefault(),s.classList.add("dragover")}),s.addEventListener("dragleave",()=>s.classList.remove("dragover")),s.addEventListener("drop",async t=>{t.preventDefault(),s.classList.remove("dragover");const e=t.dataTransfer.files&&t.dataTransfer.files[0];e&&S(await A(e))}),s.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),i.click())}),d.addEventListener("click",async()=>{const t=l.querySelector("img");if(t){d.disabled=!0,m.textContent="Analizzo…";try{const{clusters:a}=await function(t){return new Promise((e,n)=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{h.textContent=a.naturalWidth+"×"+a.naturalHeight+"px",S(t);const{pixels:n,avg:r}=function(t){const e=c("canvas"),n=e.getContext("2d"),a=Math.min(1,500/Math.max(t.width,t.height)),r=Math.max(1,Math.round(t.width*a)),o=Math.max(1,Math.round(t.height*a));e.width=r,e.height=o,n.drawImage(t,0,0,r,o);const{data:i}=n.getImageData(0,0,r,o),s=[],l=Math.max(1,Math.floor(r*o/6e3));let d=0,h=0;for(let t=0;t<i.length;t+=4*l){if(i[t+3]/255<.5)continue;const e=i[t],n=i[t+1],a=i[t+2];s.push({r:e,g:n,b:a}),d+=(e+n+a)/3,h++}return{pixels:s,w:r,h:o,avg:Math.round(d/Math.max(1,h))}}(a);g.style.width=(r/255*100).toFixed(0)+"%",u.textContent=r+" / 255",c("avg-bar-outer").setAttribute("aria-valuenow",String(r));const o=function(t,e=6,n=12){if(!t.length)return[];const a=[],r=new Set;for(;a.length<e;){const e=Math.floor(Math.random()*t.length);r.has(e)||(r.add(e),a.push({...t[e]}))}let o=new Array(t.length).fill(0);for(let r=0;r<n;r++){for(let e=0;e<t.length;e++){const n=t[e];let r=0,c=1/0;for(let t=0;t<a.length;t++){const e=a[t],o=(n.r-e.r)**2+(n.g-e.g)**2+(n.b-e.b)**2;o<c&&(c=o,r=t)}o[e]=r}const n=Array.from({length:e},()=>({r:0,g:0,b:0,count:0}));for(let e=0;e<t.length;e++){const a=t[e],r=n[o[e]];r.r+=a.r,r.g+=a.g,r.b+=a.b,r.count++}for(let t=0;t<e;t++)n[t].count>0&&(a[t]={r:Math.round(n[t].r/n[t].count),g:Math.round(n[t].g/n[t].count),b:Math.round(n[t].b/n[t].count)})}const c=Array.from({length:e},(t,e)=>({color:a[e],count:0}));return o.forEach(t=>c[t].count++),c.filter(t=>t.count>0).sort((t,e)=>e.count-t.count)}(n,6,12);e({clusters:o})},a.onerror=n,a.src=t})}(t.src);!function(t){p.innerHTML="",L=t.map(t=>({...t.color,hex:e(t.color),count:t.count})),L.forEach((t,e)=>{const a=n(t.r,t.g,t.b),r=o(t),c=document.createElement("div");c.className="swatch",c.innerHTML='<div class="chip" style="background:'+t.hex+'"></div><div class="meta"><div class="row"><span class="badge">#'+String(e+1).padStart(2,"0")+'</span><span class="badge" style="background:'+t.hex+";color:"+r.hex+'">Aa '+r.ratio.toFixed(1)+':1</span></div><div class="mt8 mono">'+t.hex.toUpperCase()+" • rgb("+t.r+", "+t.g+", "+t.b+") • hsl("+a.h+" "+a.s+"% "+a.l+"%)</div></div>",c.setAttribute("role","img"),c.setAttribute("aria-label",t.hex.toUpperCase()+" — rgb("+t.r+", "+t.g+", "+t.b+")"),p.appendChild(c)})}(a),function(){if(!L.length)return;const t=t=>n(t.r,t.g,t.b).h,a=(t,e)=>{const n=Math.abs(t-e);return Math.min(n,360-n)},r=L[0]||{hex:"#ffffff",r:255,g:255,b:255},c=L[1]||r,i=L.slice(2).length?L.slice(2):L;let s=i.filter(e=>a(t(e),t(r))>=25&&a(t(e),t(c))>=25);s.length||(s=i),s.sort((t,e)=>Math.abs(D(t,r)-4)-Math.abs(D(e,r)-4));const l=s[0]||c;let d=r,h=-1;for(const t of L){const n=D(t,r);e(t)!==e(r)&&n>h&&(h=n,d=t)}if(h<3){const t=o(r);d={hex:t.hex,r:t.rgb.r,g:t.rgb.g,b:t.rgb.b}}E={bg:r,primary:c,accent:l,text:d},["bg","primary","accent","text"].forEach(t=>{const e=f[t];e.querySelector(".chip-role").style.background=E[t].hex,e.querySelector(".role-hex").textContent=E[t].hex,e.querySelector(".chip-role").setAttribute("aria-label",`Colore ${t} ${E[t].hex}`)}),function(){if(!L.length||!E)return void(b.innerHTML="");let t=[L[0],L[1]],e=0;for(let n=0;n<L.length;n++)for(let a=n+1;a<L.length;a++){const r=Math.sqrt((L[n].r-L[a].r)**2+(L[n].g-L[a].g)**2+(L[n].b-L[a].b)**2);r>e&&(e=r,t=[L[n],L[a]])}b.innerHTML="",b.appendChild(T("Contrasto forte",t[0].hex,t[1].hex,"I due colori più diversi della foto")),b.appendChild(T("Evidenza → Principale",E.accent.hex,E.primary.hex,"Dal colore di evidenza al principale"))}()}(),m.textContent="Pronto!"}catch(t){console.error(t),m.textContent="Errore analisi immagine."}finally{d.disabled=!1}}else m.textContent="Carica prima un'immagine (o usa la demo)."}),v.addEventListener("click",async()=>{if(!L.length)return void(m.textContent="Genera la palette prima.");const t=j();(await H(t)).ok?m.textContent="CSS copiato ✅":(m.textContent="Copia bloccata. Download…",I("palette.css",t))}),y.addEventListener("click",async()=>{if(!L.length)return void(m.textContent="Genera la palette prima.");const t=R();(await H(t)).ok?m.textContent="JSON copiato ✅":(m.textContent="Copia bloccata. Download…",I("palette.json",t))}),w.addEventListener("click",()=>{L.length&&I("palette.css",j())}),C.addEventListener("click",()=>{L.length&&I("palette.json",R())}),b.addEventListener("click",async t=>{const e=t.target.closest(".grad-pill");if(!e)return;const n=e.dataset.from,a=e.dataset.to,r=e.dataset.label||"Gradiente",o="background: linear-gradient(90deg, "+n+", "+a+");",c=await H(o);m.textContent=c.ok?"Copiato: "+r+" ("+n+" → "+a+") ✅":"Copia bloccata. Download…",c.ok||I("gradient.css",o),e.classList.remove("flash"),e.offsetWidth,e.classList.add("flash")}),b.addEventListener("keydown",async t=>{if("Enter"!==t.key&&" "!==t.key)return;const e=t.target.closest(".grad-pill");if(!e)return;t.preventDefault();const n=e.dataset.from,a=e.dataset.to,r=e.dataset.label||"Gradiente",o="background: linear-gradient(90deg, "+n+", "+a+");",c=await H(o);m.textContent=c.ok?"Copiato: "+r+" ("+n+" → "+a+") ✅":"Copia bloccata. Download…",c.ok||I("gradient.css",o),e.classList.remove("flash"),e.offsetWidth,e.classList.add("flash")}),k.addEventListener("click",()=>{const t=['<svg xmlns="http://www.w3.org/2000/svg" width="800" height="500">','<defs><linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">','<stop offset="0%" stop-color="#0ea5e9"/>','<stop offset="50%" stop-color="#22d3ee"/>','<stop offset="100%" stop-color="#a78bfa"/>',"</linearGradient></defs>",'<rect width="100%" height="100%" fill="url(#g1)"/>','<circle cx="200" cy="180" r="110" fill="#f59e0b"/>','<circle cx="520" cy="320" r="140" fill="#ef4444"/>',"</svg>"].join("");S("data:image/svg+xml;utf8,"+encodeURIComponent(t))}),M.addEventListener("click",()=>{l.innerHTML='<span class="tiny">anteprima</span>',p.innerHTML='<div class="hint">Carica un\'immagine e premi “Estrai palette”.</div>',h.textContent="—",g.style.width="0%",u.textContent="—",c("avg-bar-outer").setAttribute("aria-valuenow","0"),b.innerHTML="",E=null,L=[],["bg","primary","accent","text"].forEach(t=>{f[t].querySelector(".role-hex").textContent="—",f[t].querySelector(".chip-role").style.background=""}),m.textContent="—"});try{console.assert(21===Math.round(r({r:0,g:0,b:0},{r:255,g:255,b:255})),"CR black/white=21"),console.assert("#102030"===e({r:16,g:32,b:48}),"hex ok"),x.textContent="Diagnostica: ok"}catch(i){x.textContent="Diagnostica: "+(i&&i.message?i.message:i)}}();</script></body></html>