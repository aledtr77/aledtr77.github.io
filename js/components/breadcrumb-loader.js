!function(){"use strict";const e=["/includes/","/html/includes/","/_includes/"];function t(...e){console.log("[breadcrumb-loader]",...e)}function r(t){const r=function(e){const t=(e||"").replace(/^\/+|\/+$/g,""),r=t?t.split("/").filter(Boolean):[],n=(o=e)&&(o=o.replace(/^\/+|\/+$/g,""))?o.replace(/\//g,"_").replace(/\.html$/i,""):"index";var o;const a=new Set;a.add(n+".html"),/_index$/i.test(n)&&a.add(n.replace(/_index$/i,"")+".html");const c=r.length?r[r.length-1].replace(/\.html$/i,""):"index";return a.add(c+".html"),"index"===c.toLowerCase()&&r.length>=2&&a.add(r[r.length-2].replace(/\.html$/i,"")+".html"),a.add("index.html"),Array.from(a)}(t),n=[];r.forEach(e=>n.push("/includes/"+e)),e.forEach(e=>{r.forEach(t=>n.push(e.replace(/\/+$/,"/")+t))});try{const e=window.location.origin||location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");r.forEach(t=>{n.push(e+"/includes/"+t),n.push(e+"/html/includes/"+t),n.push(e+"/_includes/"+t)})}catch(e){}return r.forEach(e=>n.push(e)),Array.from(new Set(n))}function n(e){let r=document.getElementById("breadcrumb-container");if(!r){const e=document.querySelector("header");e?(r=document.createElement("div"),r.id="breadcrumb-container",e.parentNode.insertBefore(r,e.nextSibling)):(r=document.createElement("div"),r.id="breadcrumb-container",document.body.insertBefore(r,document.body.firstChild),t("header non trovato: inserito container in cima al body (fallback)."))}r.innerHTML=e;try{!function(e){if(!e)return;const r=e.querySelector('[aria-current="page"]');if(!r)return;try{if(r.tagName&&"a"===r.tagName.toLowerCase())return void r.classList.add("breadcrumb-reset");const e=r.querySelector&&r.querySelector("a");if(e)return e.classList.add("breadcrumb-reset"),void e.setAttribute("aria-current","page");const t=(window.location&&window.location.origin||location.protocol+"//"+location.hostname+(location.port?":"+location.port:""))+(window.location&&window.location.pathname?window.location.pathname:"/"),n=document.createElement("a");for(n.href=t,n.title="Reset pagina",n.className="breadcrumb-reset",n.setAttribute("aria-current","page"),n.innerHTML=r.innerHTML||r.textContent||"Reset";r.firstChild;)r.removeChild(r.firstChild);r.appendChild(n)}catch(e){t("Errore durante makeCurrentClickable (non fatale):",e&&e.message?e.message:e)}}(r)}catch(e){t("makeCurrentClickable error:",e&&e.message?e.message:e)}if(window.rebuildBreadcrumbs)try{window.rebuildBreadcrumbs()}catch(e){t("rebuildBreadcrumbs error",e)}if(window.onBreadcrumbsLoaded)try{window.onBreadcrumbsLoaded()}catch(e){}}function o(){const e=location.pathname||"/",o=r(e);return t("Candidates:",o),function(e){let r=0;return function n(){if(r>=e.length)return Promise.resolve(null);const o=e[r++];return t("Trying fragment URL:",o),fetch(o,{cache:"no-cache"}).then(e=>(t(" ->",o,"status",e.status),e.ok?e.text().then(e=>({url:o,text:e})):n())).catch(e=>(t("fetch error for",o,e&&e.message?e.message:e),n()))}()}(o).then(r=>{r?(t("Frammento caricato da",r.url),n(r.text)):t("Nessun frammento breadcrumb trovato per",e)}).catch(e=>t("Loader error",e))}function a(e=2500){if(document.querySelector("header"))return o();const r=new MutationObserver((e,r)=>{document.querySelector("header")&&(r.disconnect(),t("Header trovato via MutationObserver."),o())});r.observe(document.documentElement,{childList:!0,subtree:!0}),setTimeout(()=>{try{r.disconnect()}catch(e){}document.querySelector("header")||t("Timeout: header non trovato entro",e,"ms â€” procedo comunque."),o()},e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>a(2500)):a(2500)}();